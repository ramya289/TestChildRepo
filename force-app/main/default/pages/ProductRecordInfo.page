<apex:page sidebar="false" standardController="BWP_Product__c" extensions="BillingRecordInfoExtension">
    <html xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
        <head>
            <meta charset="utf-8" />
            <meta http-equiv="x-ua-compatible" content="ie=edge" />
            <title>Breadwinner Product Record</title>
            <meta name="viewport" content="width=device-width, initial-scale=1" />
            <apex:slds />
            <script src="{!URLFOR($Resource.Breadwinner_Payments, 'Breadwinner_Payments/js/jquery-3.5.1.min.js')}"></script>
            <apex:variable value="{!OR($User.UIThemeDisplayed == 'Theme4d', $User.UIThemeDisplayed == 'Theme4t')}" var="isLightning" />
            <script type="text/javascript">
                j$ = jQuery.noConflict();
                j$(document).ready(function() {
                    j$('title')[0].innerText = '{!IF(productInfo.Product_Name_Full__c != null, JSENCODE(productInfo.Product_Name_Full__c) + ' | ' + JSENCODE(config.Payment_Processor_Type__c), JSENCODE(config.Payment_Processor_Type__c) + ' Product')}';
                    message();
                });
                function message() {
                    j$(".infoM6, .infoM4, .infoM3, .infoM2, .infoS1").addClass("slds-notify slds-notify_alert slds-theme_info slds-text-align_left slds-text-heading_small slds-m-bottom_small").css( {"font-weight":"500","line-height":"1.4","word-spacing":"1px","display":"block"} );
                    j$(".errorM6, .errorM4, .errorM3, .errorM2, .errorS1").addClass("slds-notify slds-notify_alert slds-theme_error slds-text-align_left slds-text-heading_small slds-m-bottom_small").css({"font-weight":"500","line-height":"1.4","word-spacing":"1px","display":"block","Justify-content":"left"});
                    j$(".warningM6, .warningM4, .warningM3, .warningM2, .warningS1").addClass("slds-notify slds-notify_alert slds-theme_warning slds-text-align_left slds-text-heading_small").css( {"font-weight":"500","line-height":"1.4","word-spacing":"1px","display":"block","Justify-content":"left"} ) ;
                    j$(".confirmM6, .confirmM4, .confirmM3, .confirmM2, .confirmS1").addClass("slds-notify slds-notify_alert slds-theme_success slds-text-align_left slds-text-heading_small slds-m-bottom_small").css( {"font-weight":"500","line-height":"1.4","word-spacing":"1px","display":"block"} ) ;
                    
                    j$("div .messageText h4").css( "color", "white" );
                    j$("div[class*='warning'] div.messageText h4").css( "color", "black" );
                    j$("table.messageTable td").css({"color" : "white"});
                    j$("div[class*='warning'] table.messageTable td").css( "color", "black" );                
                }
                function showHideSectionConent(sectionId,sectionContentId){
                    var sectiondiv=document.getElementById(sectionId);
                    j$("#"+sectionContentId).show();
                    if(j$(sectiondiv).hasClass("slds-is-open")){
                        j$(sectiondiv).removeClass("slds-is-open");
                    }
                    else{
                        j$(sectiondiv).addClass("slds-is-open");
                    }
                }
                function showhideImage(id){
                    var host = "{!LEFT($Api.Enterprise_Server_URL_330, FIND('/services',$Api.Enterprise_Server_URL_330))}";
                    var right = '{!URLFOR($Resource.Breadwinner_Payments,'Breadwinner_Payments/images/Chevronright_Black.png')}';
                    var down = '{!URLFOR($Resource.Breadwinner_Payments,'Breadwinner_Payments/images/Chevrondown_Black.png')}';
                    var rightImage = host+right.slice(1);
                    var downImage = host+down.slice(1);
                    var imgElement = document.getElementById(id);
                    imgElement.src = (imgElement.src == rightImage)? downImage : rightImage;
                }
            </script>
            <style>
                table.messageTable td img{
                display: none;
                }
                .message {
                background-color: inherit;
                border-style: none;
                padding: initial;
                margin: 0px;
                }
                .msgIcon {
                display: none;
                }
                .message .messageText {
                margin: 0px;
                }
                .message .messageText h4 {
                font-weight: inherit;
                display: initial;
                }
                .slds-scope .slds-tile+.slds-tile {
                margin-top: 0rem !important;
                }
                .slds-scope .slds-item_label {
                color: #54698d;
                padding-bottom:5px;
                font-weight: bold;
                }
                .slds-scope .slds-form-element {
                min-height: 45px;
                }
                .defIcon {
                width: 1.7rem !important;
                height: 1.7rem !important;
                }
                @media only screen and (min-width: 768px) and (max-width: 1023px) {
                .tileMedium {
                border-top: 1px solid rgb(221, 219, 218);
                padding-top: 10px;
                margin-top: 4px;
                }
                .slds-scope .slds-list_vertical {
                min-height: 45px; 
                }
                }
                @media only screen and (max-width: 767px){
                .slds-scope .slds-list_vertical .slds-item_detail{
                width: 100%;
                border-bottom: 1px solid rgb(221, 219, 218);
                margin-bottom: 4px;
                min-height: 1.5rem;
                }
                @media only screen and (max-width: 425px) {
                    .prices tr>td:nth-child(n):before {
                    width: 100%;
                    }
                    .prices tr>td:nth-child(n) {
                    text-align: left;
                    }
                }
                .slds-scope .amount {
                
                }
                .logo{
                padding-bottom:5px;
                }
                }
                .slds-scope .slds-section__title-action:hover, .slds-scope .slds-section__title-action:focus, .slds-scope .slds-section__title-action:active {
                background: rgb(243, 242, 242); box-shadow: none;
                }
            </style>
            <body style="{!IF(AND(isLightning,showBWLayout), 'background: rgba(176, 196, 223, 1);','')}">
                <div class="slds-scope">
                    <apex:form id="formId">
                        <apex:outputPanel layout="block" rendered="{!NOT(showBWLayout)}">
                            <div class="slds-box slds-align_absolute-center" style="height: 200px;">
                                <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                    <tr>
                                        <td class="image" style="width: 200px;">
                                            <apex:image url="{!URLFOR($Resource.Breadwinner_Payments,'Breadwinner_Payments/images/BreadwinnerLogo.png')}" />
                                        </td>
                                        <td class="content">
                                            <div style="text-align: center;">
                                                <apex:outputLink id="newSPMCUI" rendered="{!NOT(isLightning)}" value="{!$Page.ProductRecordInfo}?id={!recordId}&showBWLayout=true" target="_parent" style="font-size: 2.1em;">View {!config.Payment_Processor_Type__c} Product in Dedicated Layout</apex:outputLink>
                                                <apex:outputLink id="newSPMUILtng" rendered="{!isLightning}" value="{!$Page.ProductRecordInfo}?id={!recordId}&showBWLayout=true" style="font-size: 2.1em;">View {!config.Payment_Processor_Type__c} Product in Dedicated Layout</apex:outputLink>
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </apex:outputPanel>
                        <apex:outputPanel rendered="{!AND(showBWLayout,NOT(ISNULL(productInfo.id)))}" layout="block" styleClass="{!IF(isLightning,'slds-p-around_small slds-brand-band slds-brand-band_cover slds-brand-band_medium','')}">
                            <!-- Page Header Start -->
                            <div class="slds-page-header slds-m-bottom_small" role="banner">
                                <div class="slds-grid">
                                    <div class="slds-col slds-has-flexi-truncate">
                                        <div class="slds-media slds-media_center">
                                            <div class="slds-media__figure">
                                                <span class="slds-icon_container slds-icon-standard-product">
                                                    <svg class="slds-icon slds-page-header__icon" aria-hidden="true">
                                                        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS, 'assets/icons/standard-sprite/svg/symbols.svg#product')}" />
                                                    </svg>
                                                    <span class="slds-assistive-text">{!config.Payment_Processor_Type__c} Product</span>
                                                </span>
                                            </div>
                                            <div class="slds-media__body">
                                                <p>{!config.Payment_Processor_Type__c} Product</p>
                                                <p class="slds-text-heading_small slds-line-height_reset slds-page-header__title">
                                                    <apex:outputText value="{!sobj['Name']}" rendered="{!config.Payment_Processor_Type__c == 'Stripe'}" />
                                                </p>  
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div> 
                            <!-- / PAGE HEADER -->
                            <apex:pageMessages />
                            <div class="slds-card slds-p-bottom_none slds-m-bottom_small slds-grid slds-grid_vertical slds-m-top_xx-small" id="detailsSection" style="background: white;">
                                <div class="slds-card__header slds-p-bottom_small slds-border_bottom slds-m-bottom_none" >
                                    <div class="slds-grid slds-gutters slds-wrap">
                                        <apex:outputPanel styleClass="slds-col slds-tile slds-large-size_1-of-4 slds-size_1-of-1 slds-medium-size_1-of-4">
                                            <c:SldsOutputText label="Product Name" fieldValue="{!productInfo.Product_Name_Full__c}" />
                                        </apex:outputPanel>
                                        <apex:outputPanel styleClass="slds-col slds-tile slds-large-size_1-of-4 slds-size_1-of-1 slds-medium-size_1-of-4">
                                            <c:SldsOutputText label="Active" fieldValue="{!productInfo.Active__c}" />
                                        </apex:outputPanel>
                                        <apex:outputPanel styleClass="slds-col slds-tile slds-large-size_1-of-4 slds-size_1-of-1 slds-medium-size_1-of-4">
                                            <c:SldsOutputText label="Type" fieldValue="{!productInfo.Type__c}" />
                                        </apex:outputPanel>
                                        <apex:outputPanel styleClass="slds-col slds-tile slds-large-size_1-of-4 slds-size_1-of-1 slds-medium-size_1-of-4">
                                            <c:SldsOutputText label="Description" fieldValue="{!productInfo.Description__c}" />
                                        </apex:outputPanel>
                                    </div>
                                </div>
                            </div>
                            <div class="slds-card slds-grid slds-grid_vertical" style="background: white;">
                                <div class="slds-card__body slds-m-bottom_none">
                                    <!-- Additional SECTION Start -->
                                    <div class="slds-panel__section slds-p-bottom_none slds-p-top_none">
                                        <div class="slds-section"  id="SectionHeader">
                                            <h3 class="slds-section__title ">
                                                <button class="slds-button slds-section__title-action" type="button" onclick="showhideImage('{!$Component.switchAddInfo}');showHideSectionConent('SectionHeader','addSection');">
                                                    <svg aria-hidden="true" class="slds-section__title-action-icon slds-button__icon slds-button__icon_left ">
                                                        <apex:image id="switchAddInfo" value="{!URLFOR($Resource.Breadwinner_Payments,'Breadwinner_Payments/images/Chevronright_Black.png')}" style="position: absolute;" width="14" height="15" />
                                                    </svg>
                                                    Additional Information
                                                </button>
                                            </h3>
                                            <div class="slds-section__content slds-p-around_small slds-p-top_none" id="addSection">
                                                <div class="slds-grid slds-gutters_large slds-has-flexi-truncate slds-wrap slds-p-top_x-small">
                                                    <apex:outputPanel layout="block" styleClass="slds-col slds-large-size_1-of-3 slds-medium-size_1-of-2 slds-size_1-of-1 slds-large-order_1 slds-medium-order_1 slds-order_1">
                                                        <c:AdditionalInfo label="Processor Type" fieldValue="{!config.Payment_Processor_Type__c}" />
                                                    </apex:outputPanel>
                                                    <apex:outputPanel layout="block" styleClass="slds-col slds-large-size_1-of-3 slds-medium-size_1-of-2 slds-size_1-of-1 slds-large-order_2 slds-medium-order_2 slds-order_2">
                                                        <c:AdditionalInfo label="{!config.Payment_Processor_Type__c} Org Name" fieldValue="{!config.Account_Name__c}" />
                                                    </apex:outputPanel>
                                                    <apex:outputPanel layout="block" styleClass="slds-col slds-large-size_1-of-3 slds-medium-size_1-of-2 slds-size_1-of-1 slds-large-order_3 slds-medium-order_3 slds-order_3">
                                                        <c:AdditionalInfo label="{!config.Payment_Processor_Type__c} Org Id" fieldValue="{!productInfo.Processor_Org_Id__c}" />
                                                    </apex:outputPanel>
                                                    <apex:outputPanel layout="block" styleClass="slds-col slds-large-size_1-of-3 slds-medium-size_1-of-2 slds-size_1-of-1 slds-large-order_4 slds-medium-order_4 slds-order_4">
                                                        <c:AdditionalInfo label="Livemode" fieldValue="{!IF(config.Live_Mode__c,'Yes','No')}" />
                                                    </apex:outputPanel>
                                                    <apex:outputPanel layout="block" styleClass="slds-col slds-large-size_1-of-3 slds-medium-size_1-of-2 slds-size_1-of-1 slds-large-order_5 slds-medium-order_5 slds-order_5">
                                                        <div class="slds-form-element slds-border_bottom defaultHeight">
                                                            <label class="slds-form-element__label">See this Product in {!config.Payment_Processor_Type__c}</label>
                                                            <div class="slds-form-element__control">
                                                                <span class="slds-form-element__static">
                                                                    <apex:outputLink value="https://dashboard.stripe.com/test/products/{!productInfo.Processor_Id__c}" target="_blank" rendered="{!AND(NOT(config.Live_Mode__c), config.Payment_Processor_Type__c == 'Stripe')}" >Click Here</apex:outputLink>
                                                                    <apex:outputLink value="https://dashboard.stripe.com/products/{!productInfo.Processor_Id__c}" target="_blank" rendered="{!AND(config.Live_Mode__c, config.Payment_Processor_Type__c == 'Stripe')}" >Click Here</apex:outputLink>
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </apex:outputPanel>
                                                    <apex:outputPanel layout="block" styleClass="slds-col slds-large-size_1-of-3 slds-medium-size_1-of-2 slds-size_1-of-1 slds-large-order_6 slds-medium-order_6 slds-order_6">
                                                        <c:AdditionalInfo label="{!config.Payment_Processor_Type__c} Id" fieldValue="{!productInfo.Processor_Id__c}" />
                                                    </apex:outputPanel>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- Additional SECTION END -->
                                </div>
                            </div>
                            <apex:outputPanel layout="block" styleClass="slds-card__body slds-p-bottom_medium slds-card slds-m-top_small" id="relatedList">
                                <!-- Prices Section Start -->
                                <apex:outputPanel layout="block" styleClass="slds-m-top_medium slds-m-horizontal_medium">
                                    <div class="slds-media slds-media_center slds-has-flexi-truncate slds-m-bottom_x-small">
                                        <div class="slds-media__figure">
                                            <span class="slds-icon_container slds-icon-custom-custom41" title="Prices">
                                                <svg class="slds-icon slds-icon_medium" aria-hidden="true">
                                                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS, 'assets/icons/custom-sprite/svg/symbols.svg#custom41')}" />
                                                </svg>
                                                <span class="slds-assistive-text">Prices</span>
                                            </span>
                                        </div>
                                        <div class="slds-media__body">
                                            <h2 class="slds-card__header-title">
                                                <span class="slds-text-heading_small">Prices</span>
                                            </h2>
                                        </div>
                                    </div>
                                    <apex:outputPanel id="pricesList" layout="block">
                                        <apex:outputPanel layout="block" rendered="{!pricesList.size==0}" styleClass="slds-m-top_medium slds-m-horizontal_medium">
                                            <div class="slds-align_absolute-center slds-border_top slds-border_bottom slds-p-top_small slds-p-bottom_small">
                                                No Prices are related to this Product
                                            </div>
                                        </apex:outputPanel>
                                        <apex:outputPanel rendered="{!pricesList.size>0}">
                                            <apex:DataTable value="{!pricesList}" var="price" styleclass="slds-table slds-no-row-hover slds-table_bordered slds-table_col-bordered slds-border_right slds-border_bottom slds-border_left myTableRow slds-max-medium-table_stacked-horizontal prices">
                                                <apex:column headerValue="Price #" html-data-label="Price #">
                                                    <apex:outputLink value="/{!URLFOR(price.id)}" target="_blank" rendered="{!NOT(ISNULL(price.id))}">{!price.Name}</apex:outputLink>
                                                </apex:column>
                                                <apex:column headerValue="Currency" html-data-label="Currency" styleClass="slds-cell-wrap" value="{!price.Currency__c}" />
                                                <apex:column headerValue="Type" html-data-label="Type" styleClass="slds-cell-wrap" value="{!price.Type__c}" />
                                                <apex:column headerValue="Interval Count" html-data-label="Interval Count" styleClass="slds-cell-wrap slds-text-align_right" headerClass="slds-text-align_right" value="{!price.Recurring_Interval_Count__c}" />
                                                <apex:column headerValue="Interval" html-data-label="Interval" styleClass="slds-cell-wrap" value="{!price.Recurring_Interval__c}" />
                                                <apex:column headerValue="Unit Amount" html-data-label="Unit Amount" styleClass="slds-text-align_right" headerClass="slds-text-align_right" value="{!price.Unit_Amount__c}" />
                                            </apex:DataTable>
                                        </apex:outputPanel>
                                    </apex:outputPanel>
                                </apex:outputPanel>
                                <!-- Prices Section END -->
                            </apex:outputPanel>
                        </apex:outputPanel>
                    </apex:form>
                </div>
            </body>
        </head>
    </html>
</apex:page>